<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест обработки LaTeX</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <h1>Тест обработки LaTeX формул</h1>
    <div id="content">
        <p>Формула в квадратных скобках: [ P_{газ,X} = P_{газ,X-1} \cdot R_{газ,X}, ]</p>
        <p>Формула в круглых скобках: ( P_{газ,X} )</p>
        <p>Старый формат: $$x = y + z$$</p>
        <p>Старый inline формат: $a^2 + b^2 = c^2$</p>
    </div>

    <script>
        // Замена LaTeX формул на теги MathJax
        function replaceLatex(text) {
            // Заменяем формулы в квадратных скобках [...] на блочные теги MathJax
            text = text.replace(/\[\s*\\?[(\[](.+?)\\?[)\]]\s*\]/g, '\\[$1\\]');
            // Заменяем формулы в круглых скобках (...) на inline теги MathJax
            text = text.replace(/\(\s*\\?[(\[](.+?)\\?[)\]]\s*\)/g, '\\($1\\)');
            // Также поддерживаем старые форматы $...$ и $$...$$
            text = text.replace(/\$\$(.*?)\$\$/g, '\\[$1\\]');
            text = text.replace(/\$(.*?)\$/g, '\\($1\\)');
            return text;
        }

        // Применяем обработку к содержимому
        const contentDiv = document.getElementById('content');
        const originalText = contentDiv.innerHTML;
        const processedText = replaceLatex(originalText);
        contentDiv.innerHTML = processedText;

        // Обновляем MathJax после вставки контента
        if (typeof MathJax !== 'undefined') {
            MathJax.typesetPromise([contentDiv]);
        }
    </script>
</body>
</html>