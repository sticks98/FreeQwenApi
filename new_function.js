        // Замена LaTeX формул на теги MathJax
        function replaceLatex(text) {
            // Заменяем блочные формулы \\[ ... ]\\ на MathJax блочные теги \\[ ... \\]
            text = text.replace(/\\\\\\[(.*?)\\\\\]/g, '\\\\\\\\[$1\\\\\\\\]');
            // Заменяем экранированные inline формулы \\\\( ... \\\\) на MathJax inline теги
            text = text.replace(/\\\\\\((.*?)\\\\\\)/g, '\\\\\\\\($1\\\\\\\\)');
            // Также поддерживаем старые форматы $...$ и $$...$$
            text = text.replace(/\\\\$\\\\$(.*?)\\\\$\\\\$/g, '\\\\\\\\[$1\\\\\\\\]');
            text = text.replace(/\\\\$(.*?)\\\\$/g, '\\\\\\\\($1\\\\\\\\)');
            return text;
        }